Index: SpendingApp/Program.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>using SpendingApp.Persistence;\r\n\r\nvar builder = WebApplication.CreateBuilder(args);\r\n\r\n// Add services to the container.\r\n\r\nbuilder.Services.AddControllers();\r\nbuilder.Services.AddDbContext<SpendingContext>();\r\nbuilder.Services.AddCors(options =>\r\n{\r\n    options.AddPolicy(\"\", policy =>\r\n    {\r\n        policy.AllowAnyOrigin();\r\n        policy.AllowAnyMethod();\r\n    });\r\n});\r\n\r\nbuilder.Services.AddEndpointsApiExplorer();\r\nbuilder.Services.AddSwaggerGen();\r\n\r\nvar app = builder.Build();\r\n\r\n// Configure the HTTP request pipeline.\r\nif (app.Environment.IsDevelopment())\r\n{\r\n    app.UseSwagger();\r\n    app.UseSwaggerUI();\r\n}\r\n\r\napp.UseHttpsRedirection();\r\n\r\napp.UseAuthorization();\r\n\r\napp.MapControllers();\r\n\r\napp.Run();
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Program.cs b/SpendingApp/Program.cs
--- a/SpendingApp/Program.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/SpendingApp/Program.cs	(date 1670184089583)
@@ -1,4 +1,5 @@
 using SpendingApp.Persistence;
+using SpendingApp.Persistence.Migrations.Helpers;
 
 var builder = WebApplication.CreateBuilder(args);
 
@@ -20,6 +21,8 @@
 
 var app = builder.Build();
 
+app.ApplyMigrations();
+
 // Configure the HTTP request pipeline.
 if (app.Environment.IsDevelopment())
 {
Index: SpendingApp/appsettings.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\r\n  \"Logging\": {\r\n    \"LogLevel\": {\r\n      \"Default\": \"Information\",\r\n      \"Microsoft.AspNetCore\": \"Warning\"\r\n    }\r\n  },\r\n  \"AllowedHosts\": \"*\",\r\n  \"ConnectionStrings\": {\r\n    \"Spending\": \"Server=DESKTOP-F80DM1G;Database=exam;Trusted_Connection=True;\"\r\n  }\r\n}\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/appsettings.json b/SpendingApp/appsettings.json
--- a/SpendingApp/appsettings.json	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/SpendingApp/appsettings.json	(date 1670184121495)
@@ -7,6 +7,6 @@
   },
   "AllowedHosts": "*",
   "ConnectionStrings": {
-    "Spending": "Server=DESKTOP-F80DM1G;Database=exam;Trusted_Connection=True;"
+    "Spending": "Data Source=spending-mssql-service,1433;Initial Catalog=SpendingDb;Persist Security Info=True;User ID=SA;Password=vV5r9tn0M4@"
   }
 }
Index: SpendingApp/Migrations/20221110195816_InitialMigration.cs
===================================================================
diff --git a/SpendingApp/Migrations/20221110195816_InitialMigration.cs b/SpendingApp/Migrations/20221110195816_InitialMigration.cs
deleted file mode 100644
--- a/SpendingApp/Migrations/20221110195816_InitialMigration.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ /dev/null	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
@@ -1,31 +0,0 @@
-using Microsoft.EntityFrameworkCore.Migrations;
-
-#nullable disable
-
-namespace SpendingApp.Migrations
-{
-    public partial class InitialMigration : Migration
-    {
-        protected override void Up(MigrationBuilder migrationBuilder)
-        {
-            migrationBuilder.CreateTable(
-                name: "Pings",
-                columns: table => new
-                {
-                    Id = table.Column<int>(type: "int", nullable: false)
-                        .Annotation("SqlServer:Identity", "1, 1"),
-                    Counter = table.Column<int>(type: "int", nullable: false)
-                },
-                constraints: table =>
-                {
-                    table.PrimaryKey("PK_Pings", x => x.Id);
-                });
-        }
-
-        protected override void Down(MigrationBuilder migrationBuilder)
-        {
-            migrationBuilder.DropTable(
-                name: "Pings");
-        }
-    }
-}
Index: SpendingApp/Migrations/20221110195816_InitialMigration.Designer.cs
===================================================================
diff --git a/SpendingApp/Migrations/20221110195816_InitialMigration.Designer.cs b/SpendingApp/Migrations/20221110195816_InitialMigration.Designer.cs
deleted file mode 100644
--- a/SpendingApp/Migrations/20221110195816_InitialMigration.Designer.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ /dev/null	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
@@ -1,44 +0,0 @@
-// <auto-generated />
-using Microsoft.EntityFrameworkCore;
-using Microsoft.EntityFrameworkCore.Infrastructure;
-using Microsoft.EntityFrameworkCore.Metadata;
-using Microsoft.EntityFrameworkCore.Migrations;
-using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
-using SpendingApp.Persistence;
-
-#nullable disable
-
-namespace SpendingApp.Migrations
-{
-    [DbContext(typeof(SpendingContext))]
-    [Migration("20221110195816_InitialMigration")]
-    partial class InitialMigration
-    {
-        protected override void BuildTargetModel(ModelBuilder modelBuilder)
-        {
-#pragma warning disable 612, 618
-            modelBuilder
-                .HasAnnotation("ProductVersion", "6.0.0")
-                .HasAnnotation("Relational:MaxIdentifierLength", 128);
-
-            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
-
-            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
-                {
-                    b.Property<int>("Id")
-                        .ValueGeneratedOnAdd()
-                        .HasColumnType("int");
-
-                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
-
-                    b.Property<int>("Counter")
-                        .HasColumnType("int");
-
-                    b.HasKey("Id");
-
-                    b.ToTable("Pings");
-                });
-#pragma warning restore 612, 618
-        }
-    }
-}
Index: SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs
===================================================================
diff --git a/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs b/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs
deleted file mode 100644
--- a/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ /dev/null	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
@@ -1,50 +0,0 @@
-using Microsoft.EntityFrameworkCore.Migrations;
-
-#nullable disable
-
-namespace SpendingApp.Migrations
-{
-    public partial class CreateSpendingTable : Migration
-    {
-        protected override void Up(MigrationBuilder migrationBuilder)
-        {
-            migrationBuilder.Sql(@"
-				IF OBJECT_ID('dbo.Pings', 'u' ) is not null
-				begin 
-					drop table dbo.Pings
-				end
-				
-				IF OBJECT_ID('dbo.Spendings', 'u' ) is null
-				begin 
-					create table dbo.Spendings
-					(
-						Id int identity(1,1),
-						Currency tinyint not null,
-						[Value] int not null,
-						[Item] nvarchar(max),
-
-						constraint PK_Spendings primary key clustered (Id asc)
-					)
-				end");
-        }
-
-        protected override void Down(MigrationBuilder migrationBuilder)
-        {
-	        migrationBuilder.Sql(@"
-				IF OBJECT_ID('dbo.Pings', 'u' ) is null
-				begin 
-					CREATE TABLE [dbo].[Pings]
-					(
-						[Id] [int] IDENTITY(1,1) NOT NULL,
-						[Counter] [int] NOT NULL,
-					 	CONSTRAINT [PK_Pings] PRIMARY KEY CLUSTERED ([Id] ASC)
-					)
-				end
-
-				IF OBJECT_ID('dbo.Spendings', 'u' ) is not null
-				begin 
-					drop table dbo.Spendings
-				end");
-        }
-    }
-}
Index: SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs
===================================================================
diff --git a/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs b/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs
deleted file mode 100644
--- a/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ /dev/null	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
@@ -1,44 +0,0 @@
-// <auto-generated />
-using Microsoft.EntityFrameworkCore;
-using Microsoft.EntityFrameworkCore.Infrastructure;
-using Microsoft.EntityFrameworkCore.Metadata;
-using Microsoft.EntityFrameworkCore.Migrations;
-using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
-using SpendingApp.Persistence;
-
-#nullable disable
-
-namespace SpendingApp.Migrations
-{
-    [DbContext(typeof(SpendingContext))]
-    [Migration("20221110213358_CreateSpendingTable")]
-    partial class CreateSpendingTable
-    {
-        protected override void BuildTargetModel(ModelBuilder modelBuilder)
-        {
-#pragma warning disable 612, 618
-            modelBuilder
-                .HasAnnotation("ProductVersion", "6.0.0")
-                .HasAnnotation("Relational:MaxIdentifierLength", 128);
-
-            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
-
-            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
-                {
-                    b.Property<int>("Id")
-                        .ValueGeneratedOnAdd()
-                        .HasColumnType("int");
-
-                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
-
-                    b.Property<int>("Counter")
-                        .HasColumnType("int");
-
-                    b.HasKey("Id");
-
-                    b.ToTable("Pings");
-                });
-#pragma warning restore 612, 618
-        }
-    }
-}
Index: SpendingApp/Migrations/SpendingContextModelSnapshot.cs
===================================================================
diff --git a/SpendingApp/Migrations/SpendingContextModelSnapshot.cs b/SpendingApp/Migrations/SpendingContextModelSnapshot.cs
deleted file mode 100644
--- a/SpendingApp/Migrations/SpendingContextModelSnapshot.cs	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ /dev/null	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
@@ -1,42 +0,0 @@
-// <auto-generated />
-using Microsoft.EntityFrameworkCore;
-using Microsoft.EntityFrameworkCore.Infrastructure;
-using Microsoft.EntityFrameworkCore.Metadata;
-using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
-using SpendingApp.Persistence;
-
-#nullable disable
-
-namespace SpendingApp.Migrations
-{
-    [DbContext(typeof(SpendingContext))]
-    partial class SpendingContextModelSnapshot : ModelSnapshot
-    {
-        protected override void BuildModel(ModelBuilder modelBuilder)
-        {
-#pragma warning disable 612, 618
-            modelBuilder
-                .HasAnnotation("ProductVersion", "6.0.0")
-                .HasAnnotation("Relational:MaxIdentifierLength", 128);
-
-            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
-
-            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
-                {
-                    b.Property<int>("Id")
-                        .ValueGeneratedOnAdd()
-                        .HasColumnType("int");
-
-                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
-
-                    b.Property<int>("Counter")
-                        .HasColumnType("int");
-
-                    b.HasKey("Id");
-
-                    b.ToTable("Pings");
-                });
-#pragma warning restore 612, 618
-        }
-    }
-}
Index: SpendingApp.Migrations/Dockerfile
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp.Migrations/Dockerfile b/SpendingApp.Migrations/Dockerfile
new file mode 100644
--- /dev/null	(date 1670184089559)
+++ b/SpendingApp.Migrations/Dockerfile	(date 1670184089559)
@@ -0,0 +1,19 @@
+FROM mcr.microsoft.com/dotnet/aspnet:6.0 AS base
+WORKDIR /app
+EXPOSE 80
+
+FROM mcr.microsoft.com/dotnet/sdk:6.0 AS build
+WORKDIR /src
+COPY ["SpendingApp.Migrations/SpendingApp.Migrations.csproj", "SpendingApp.Migrations/"]
+COPY ["SpendingApp/SpendingApp.csproj", "SpendingApp/"]
+RUN dotnet restore "SpendingApp.Migrations/SpendingApp.Migrations.csproj"
+COPY . .
+WORKDIR "/src/SpendingApp.Migrations"
+RUN dotnet build "SpendingApp.Migrations.csproj" -c Release -o /app/build
+
+FROM build AS publish
+RUN dotnet publish "SpendingApp.Migrations.csproj" -c Release -o /app/publish
+
+FROM base AS final
+WORKDIR /app
+COPY --from=publish /app/publish .
Index: SpendingApp/SpendingApp.csproj
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><Project Sdk=\"Microsoft.NET.Sdk.Web\">\r\n\r\n    <PropertyGroup>\r\n        <TargetFramework>net6.0</TargetFramework>\r\n        <Nullable>enable</Nullable>\r\n        <ImplicitUsings>enable</ImplicitUsings>\r\n        <DockerDefaultTargetOS>Linux</DockerDefaultTargetOS>\r\n    </PropertyGroup>\r\n\r\n    <ItemGroup>\r\n        <PackageReference Include=\"EntityFramework\" Version=\"6.0.0\" />\r\n        <PackageReference Include=\"Microsoft.EntityFrameworkCore\" Version=\"6.0.0\" />\r\n        <PackageReference Include=\"Microsoft.EntityFrameworkCore.Design\" Version=\"6.0.0\">\r\n          <PrivateAssets>all</PrivateAssets>\r\n          <IncludeAssets>runtime; build; native; contentfiles; analyzers; buildtransitive</IncludeAssets>\r\n        </PackageReference>\r\n        <PackageReference Include=\"Microsoft.EntityFrameworkCore.SqlServer\" Version=\"6.0.0\" />\r\n        <PackageReference Include=\"Swashbuckle.AspNetCore\" Version=\"6.2.3\" />\r\n    </ItemGroup>\r\n\r\n    <ItemGroup>\r\n      <Folder Include=\"Migrations\" />\r\n    </ItemGroup>\r\n\r\n</Project>\r\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/SpendingApp.csproj b/SpendingApp/SpendingApp.csproj
--- a/SpendingApp/SpendingApp.csproj	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/SpendingApp/SpendingApp.csproj	(date 1670184089583)
@@ -18,8 +18,4 @@
         <PackageReference Include="Swashbuckle.AspNetCore" Version="6.2.3" />
     </ItemGroup>
 
-    <ItemGroup>
-      <Folder Include="Migrations" />
-    </ItemGroup>
-
 </Project>
Index: SpendingApp.Migrations/.dockerignore
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp.Migrations/.dockerignore b/SpendingApp.Migrations/.dockerignore
new file mode 100644
--- /dev/null	(date 1670184089559)
+++ b/SpendingApp.Migrations/.dockerignore	(date 1670184089559)
@@ -0,0 +1,25 @@
+**/.dockerignore
+**/.env
+**/.git
+**/.gitignore
+**/.project
+**/.settings
+**/.toolstarget
+**/.vs
+**/.vscode
+**/.idea
+**/*.*proj.user
+**/*.dbmdl
+**/*.jfm
+**/azds.yaml
+**/bin
+**/charts
+**/docker-compose*
+**/Dockerfile*
+**/node_modules
+**/npm-debug.log
+**/obj
+**/secrets.dev.yaml
+**/values.dev.yaml
+LICENSE
+README.md
\ No newline at end of file
Index: SpendingApp.Migrations/SpendingApp.Migrations.csproj
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp.Migrations/SpendingApp.Migrations.csproj b/SpendingApp.Migrations/SpendingApp.Migrations.csproj
new file mode 100644
--- /dev/null	(date 1670184089579)
+++ b/SpendingApp.Migrations/SpendingApp.Migrations.csproj	(date 1670184089579)
@@ -0,0 +1,24 @@
+<Project Sdk="Microsoft.NET.Sdk.Web">
+
+    <PropertyGroup>
+        <TargetFramework>net6.0</TargetFramework>
+        <Nullable>enable</Nullable>
+        <ImplicitUsings>enable</ImplicitUsings>
+        <DockerDefaultTargetOS>Linux</DockerDefaultTargetOS>
+        <OutputType>Library</OutputType>
+    </PropertyGroup>
+
+    <ItemGroup>
+      <PackageReference Include="EntityFramework" Version="6.0.0" />
+      <PackageReference Include="Microsoft.EntityFrameworkCore.Relational" Version="6.0.0" />
+    </ItemGroup>
+
+    <ItemGroup>
+      <ProjectReference Include="..\SpendingApp\SpendingApp.csproj" />
+    </ItemGroup>
+
+    <ItemGroup>
+      <Folder Include="Migrations" />
+    </ItemGroup>
+
+</Project>
Index: .idea/.idea.SpendingApp/.idea/workspace.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<project version=\"4\">\r\n  <component name=\"AutoGeneratedRunConfigurationManager\">\r\n    <projectFile profileName=\"SpendingApp\">SpendingApp/SpendingApp.csproj</projectFile>\r\n    <projectFile profileName=\"IIS Express\">SpendingApp/SpendingApp.csproj</projectFile>\r\n  </component>\r\n  <component name=\"ChangeListManager\">\r\n    <list default=\"true\" id=\"ac4cd86d-85fa-4ccb-8d07-c2e42d2f6dfb\" name=\"Changes\" comment=\"\">\r\n      <change afterPath=\"$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs\" afterDir=\"false\" />\r\n      <change afterPath=\"$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/.idea/.idea.SpendingApp/.idea/workspace.xml\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/.idea/.idea.SpendingApp/.idea/workspace.xml\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SpendingApp/Controllers/SpendingController.cs\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/SpendingApp/Controllers/SpendingController.cs\" afterDir=\"false\" />\r\n      <change beforePath=\"$PROJECT_DIR$/SpendingApp/Persistence/SpendingContext.cs\" beforeDir=\"false\" afterPath=\"$PROJECT_DIR$/SpendingApp/Persistence/SpendingContext.cs\" afterDir=\"false\" />\r\n    </list>\r\n    <option name=\"SHOW_DIALOG\" value=\"false\" />\r\n    <option name=\"HIGHLIGHT_CONFLICTS\" value=\"true\" />\r\n    <option name=\"HIGHLIGHT_NON_ACTIVE_CHANGELIST\" value=\"false\" />\r\n    <option name=\"LAST_RESOLUTION\" value=\"IGNORE\" />\r\n  </component>\r\n  <component name=\"Git.Settings\">\r\n    <option name=\"RECENT_GIT_ROOT_PATH\" value=\"$PROJECT_DIR$/../..\" />\r\n  </component>\r\n  <component name=\"GitSEFilterConfiguration\">\r\n    <file-type-list>\r\n      <filtered-out-file-type name=\"LOCAL_BRANCH\" />\r\n      <filtered-out-file-type name=\"REMOTE_BRANCH\" />\r\n      <filtered-out-file-type name=\"TAG\" />\r\n      <filtered-out-file-type name=\"COMMIT_BY_MESSAGE\" />\r\n    </file-type-list>\r\n  </component>\r\n  <component name=\"HighlightingSettingsPerFile\">\r\n    <setting file=\"file://$APPLICATION_CONFIG_DIR$/resharper-host/SourcesCache/3685646f2f29e671aaf1cda7eb01c84daaec2ae61820d2c444edc3121d696/DbContext.cs\" root0=\"SKIP_HIGHLIGHTING\" />\r\n  </component>\r\n  <component name=\"MarkdownSettingsMigration\">\r\n    <option name=\"stateVersion\" value=\"1\" />\r\n  </component>\r\n  <component name=\"ProjectId\" id=\"2GDLYCHT3sIoTcVTw304P6yTMzE\" />\r\n  <component name=\"ProjectLevelVcsManager\" settingsEditedManually=\"true\" />\r\n  <component name=\"ProjectViewState\">\r\n    <option name=\"hideEmptyMiddlePackages\" value=\"true\" />\r\n    <option name=\"showLibraryContents\" value=\"true\" />\r\n  </component>\r\n  <component name=\"PropertiesComponent\">\r\n    <property name=\"RunOnceActivity.OpenProjectViewOnStart\" value=\"true\" />\r\n    <property name=\"RunOnceActivity.ShowReadmeOnStart\" value=\"true\" />\r\n    <property name=\"WebServerToolWindowFactoryState\" value=\"false\" />\r\n    <property name=\"nodejs_package_manager_path\" value=\"npm\" />\r\n    <property name=\"vue.rearranger.settings.migration\" value=\"true\" />\r\n  </component>\r\n  <component name=\"RunManager\" selected=\".NET Launch Settings Profile.SpendingApp\">\r\n    <configuration name=\"SpendingApp\" type=\"LaunchSettings\" factoryName=\".NET Launch Settings Profile\">\r\n      <option name=\"LAUNCH_PROFILE_PROJECT_FILE_PATH\" value=\"$PROJECT_DIR$/SpendingApp/SpendingApp.csproj\" />\r\n      <option name=\"LAUNCH_PROFILE_TFM\" value=\"net6.0\" />\r\n      <option name=\"LAUNCH_PROFILE_NAME\" value=\"SpendingApp\" />\r\n      <option name=\"USE_EXTERNAL_CONSOLE\" value=\"0\" />\r\n      <option name=\"USE_MONO\" value=\"0\" />\r\n      <option name=\"RUNTIME_ARGUMENTS\" value=\"\" />\r\n      <option name=\"GENERATE_APPLICATIONHOST_CONFIG\" value=\"1\" />\r\n      <option name=\"SHOW_IIS_EXPRESS_OUTPUT\" value=\"0\" />\r\n      <option name=\"SEND_DEBUG_REQUEST\" value=\"1\" />\r\n      <option name=\"ADDITIONAL_IIS_EXPRESS_ARGUMENTS\" value=\"\" />\r\n      <method v=\"2\">\r\n        <option name=\"Build\" />\r\n      </method>\r\n    </configuration>\r\n    <configuration name=\"SpendingApp: IIS Express\" type=\"LaunchSettings\" factoryName=\".NET Launch Settings Profile\">\r\n      <option name=\"LAUNCH_PROFILE_PROJECT_FILE_PATH\" value=\"$PROJECT_DIR$/SpendingApp/SpendingApp.csproj\" />\r\n      <option name=\"LAUNCH_PROFILE_TFM\" value=\"net6.0\" />\r\n      <option name=\"LAUNCH_PROFILE_NAME\" value=\"IIS Express\" />\r\n      <option name=\"USE_EXTERNAL_CONSOLE\" value=\"0\" />\r\n      <option name=\"USE_MONO\" value=\"0\" />\r\n      <option name=\"RUNTIME_ARGUMENTS\" value=\"\" />\r\n      <option name=\"GENERATE_APPLICATIONHOST_CONFIG\" value=\"1\" />\r\n      <option name=\"SHOW_IIS_EXPRESS_OUTPUT\" value=\"0\" />\r\n      <option name=\"SEND_DEBUG_REQUEST\" value=\"1\" />\r\n      <option name=\"ADDITIONAL_IIS_EXPRESS_ARGUMENTS\" value=\"\" />\r\n      <method v=\"2\">\r\n        <option name=\"Build\" />\r\n      </method>\r\n    </configuration>\r\n  </component>\r\n  <component name=\"SpellCheckerSettings\" RuntimeDictionaries=\"0\" Folders=\"0\" CustomDictionaries=\"0\" DefaultDictionary=\"application-level\" UseSingleDictionary=\"true\" transferred=\"true\" />\r\n  <component name=\"TaskManager\">\r\n    <task active=\"true\" id=\"Default\" summary=\"Default task\">\r\n      <changelist id=\"ac4cd86d-85fa-4ccb-8d07-c2e42d2f6dfb\" name=\"Changes\" comment=\"\" />\r\n      <created>1665918252868</created>\r\n      <option name=\"number\" value=\"Default\" />\r\n      <option name=\"presentableId\" value=\"Default\" />\r\n      <updated>1665918252868</updated>\r\n      <workItem from=\"1665918253816\" duration=\"6251000\" />\r\n      <workItem from=\"1665992214840\" duration=\"3887000\" />\r\n      <workItem from=\"1666470288395\" duration=\"1873000\" />\r\n      <workItem from=\"1666540225155\" duration=\"6175000\" />\r\n      <workItem from=\"1667045271077\" duration=\"613000\" />\r\n      <workItem from=\"1667683645329\" duration=\"1494000\" />\r\n      <workItem from=\"1667730880014\" duration=\"665000\" />\r\n      <workItem from=\"1668106000082\" duration=\"7678000\" />\r\n    </task>\r\n    <servers />\r\n  </component>\r\n  <component name=\"TypeScriptGeneratedFilesManager\">\r\n    <option name=\"version\" value=\"3\" />\r\n  </component>\r\n  <component name=\"UnityProjectConfiguration\" hasMinimizedUI=\"false\" />\r\n  <component name=\"UnityUnitTestConfiguration\" currentTestLauncher=\"NUnit\" />\r\n  <component name=\"VcsManagerConfiguration\">\r\n    <option name=\"CLEAR_INITIAL_COMMIT_MESSAGE\" value=\"true\" />\r\n  </component>\r\n  <component name=\"XDebuggerManager\">\r\n    <breakpoint-manager>\r\n      <breakpoints>\r\n        <line-breakpoint enabled=\"true\" type=\"DotNet Breakpoints\">\r\n          <url>file://$PROJECT_DIR$/SpendingApp/Controllers/SpendingController.cs</url>\r\n          <line>27</line>\r\n          <properties documentPath=\"D:\\MY PROGS AMA GANGSTA NAH\\microservices\\laba1\\Microservices3course\\SpendingService\\SpendingApp\\SpendingApp\\Controllers\\SpendingController.cs\" initialLine=\"27\" containingFunctionPresentation=\"method 'Add'\">\r\n            <startOffsets>\r\n              <option value=\"552\" />\r\n            </startOffsets>\r\n            <endOffsets>\r\n              <option value=\"710\" />\r\n            </endOffsets>\r\n          </properties>\r\n          <option name=\"timeStamp\" value=\"1\" />\r\n        </line-breakpoint>\r\n      </breakpoints>\r\n    </breakpoint-manager>\r\n  </component>\r\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/.idea.SpendingApp/.idea/workspace.xml b/.idea/.idea.SpendingApp/.idea/workspace.xml
--- a/.idea/.idea.SpendingApp/.idea/workspace.xml	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/.idea/.idea.SpendingApp/.idea/workspace.xml	(date 1670184089558)
@@ -3,14 +3,27 @@
   <component name="AutoGeneratedRunConfigurationManager">
     <projectFile profileName="SpendingApp">SpendingApp/SpendingApp.csproj</projectFile>
     <projectFile profileName="IIS Express">SpendingApp/SpendingApp.csproj</projectFile>
+    <projectFile profileName="SpendingApp.Migrations">SpendingApp.Migrations/SpendingApp.Migrations.csproj</projectFile>
+    <projectFile profileName="IIS Express">SpendingApp.Migrations/SpendingApp.Migrations.csproj</projectFile>
   </component>
   <component name="ChangeListManager">
     <list default="true" id="ac4cd86d-85fa-4ccb-8d07-c2e42d2f6dfb" name="Changes" comment="">
-      <change afterPath="$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs" afterDir="false" />
-      <change afterPath="$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/SpendingApp.Migrations/.dockerignore" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/SpendingApp.Migrations/Dockerfile" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/SpendingApp.Migrations/Properties/launchSettings.json" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/SpendingApp.Migrations/SpendingApp.Migrations.csproj" afterDir="false" />
+      <change afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/Helpers/MigrationsHelper.cs" afterDir="false" />
       <change beforePath="$PROJECT_DIR$/.idea/.idea.SpendingApp/.idea/workspace.xml" beforeDir="false" afterPath="$PROJECT_DIR$/.idea/.idea.SpendingApp/.idea/workspace.xml" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/SpendingApp/Controllers/SpendingController.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Controllers/SpendingController.cs" afterDir="false" />
-      <change beforePath="$PROJECT_DIR$/SpendingApp/Persistence/SpendingContext.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/SpendingContext.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Migrations/20221110195816_InitialMigration.Designer.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.Designer.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Migrations/20221110195816_InitialMigration.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.Designer.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.Designer.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Migrations/20221110213358_CreateSpendingTable.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Migrations/SpendingContextModelSnapshot.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Persistence/Migrations/SpendingContextModelSnapshot.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/Program.cs" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/Program.cs" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/SpendingApp/SpendingApp.csproj" beforeDir="false" afterPath="$PROJECT_DIR$/SpendingApp/SpendingApp.csproj" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/../../k8s/postgres/secret.yaml" beforeDir="false" afterPath="$PROJECT_DIR$/../../k8s/postgres/secret.yaml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/../../k8s/postgres/storage.yaml" beforeDir="false" afterPath="$PROJECT_DIR$/../../k8s/postgres/storage.yaml" afterDir="false" />
+      <change beforePath="$PROJECT_DIR$/../../k8s/spending/deployment.yaml" beforeDir="false" afterPath="$PROJECT_DIR$/../../k8s/spending/deployment.yaml" afterDir="false" />
     </list>
     <option name="SHOW_DIALOG" value="false" />
     <option name="HIGHLIGHT_CONFLICTS" value="true" />
@@ -30,9 +43,14 @@
   </component>
   <component name="HighlightingSettingsPerFile">
     <setting file="file://$APPLICATION_CONFIG_DIR$/resharper-host/SourcesCache/3685646f2f29e671aaf1cda7eb01c84daaec2ae61820d2c444edc3121d696/DbContext.cs" root0="SKIP_HIGHLIGHTING" />
+    <setting file="file://$APPLICATION_CONFIG_DIR$/resharper-host/SourcesCache/575c31ecc35a636b6f962cb71d53992552941a18982aae1c8e6c16305cc3761b/ExceptionDispatchInfo.cs" root0="SKIP_HIGHLIGHTING" />
+    <setting file="file://$APPLICATION_CONFIG_DIR$/resharper-host/DecompilerCache/decompiler/1ba52dc0b103422eba91ad87a1aa9fe314378/7c/c646a165/ServiceProviderServiceExtensions.cs" root0="SKIP_HIGHLIGHTING" />
   </component>
   <component name="MarkdownSettingsMigration">
     <option name="stateVersion" value="1" />
+  </component>
+  <component name="ProblemsViewState">
+    <option name="selectedTabId" value="SWEA" />
   </component>
   <component name="ProjectId" id="2GDLYCHT3sIoTcVTw304P6yTMzE" />
   <component name="ProjectLevelVcsManager" settingsEditedManually="true" />
@@ -65,6 +83,36 @@
     </configuration>
     <configuration name="SpendingApp: IIS Express" type="LaunchSettings" factoryName=".NET Launch Settings Profile">
       <option name="LAUNCH_PROFILE_PROJECT_FILE_PATH" value="$PROJECT_DIR$/SpendingApp/SpendingApp.csproj" />
+      <option name="LAUNCH_PROFILE_TFM" value="net6.0" />
+      <option name="LAUNCH_PROFILE_NAME" value="IIS Express" />
+      <option name="USE_EXTERNAL_CONSOLE" value="0" />
+      <option name="USE_MONO" value="0" />
+      <option name="RUNTIME_ARGUMENTS" value="" />
+      <option name="GENERATE_APPLICATIONHOST_CONFIG" value="1" />
+      <option name="SHOW_IIS_EXPRESS_OUTPUT" value="0" />
+      <option name="SEND_DEBUG_REQUEST" value="1" />
+      <option name="ADDITIONAL_IIS_EXPRESS_ARGUMENTS" value="" />
+      <method v="2">
+        <option name="Build" />
+      </method>
+    </configuration>
+    <configuration name="SpendingApp.Migrations" type="LaunchSettings" factoryName=".NET Launch Settings Profile">
+      <option name="LAUNCH_PROFILE_PROJECT_FILE_PATH" value="$PROJECT_DIR$/SpendingApp.Migrations/SpendingApp.Migrations.csproj" />
+      <option name="LAUNCH_PROFILE_TFM" value="net6.0" />
+      <option name="LAUNCH_PROFILE_NAME" value="SpendingApp.Migrations" />
+      <option name="USE_EXTERNAL_CONSOLE" value="0" />
+      <option name="USE_MONO" value="0" />
+      <option name="RUNTIME_ARGUMENTS" value="" />
+      <option name="GENERATE_APPLICATIONHOST_CONFIG" value="1" />
+      <option name="SHOW_IIS_EXPRESS_OUTPUT" value="0" />
+      <option name="SEND_DEBUG_REQUEST" value="1" />
+      <option name="ADDITIONAL_IIS_EXPRESS_ARGUMENTS" value="" />
+      <method v="2">
+        <option name="Build" />
+      </method>
+    </configuration>
+    <configuration name="SpendingApp.Migrations: IIS Express" type="LaunchSettings" factoryName=".NET Launch Settings Profile">
+      <option name="LAUNCH_PROFILE_PROJECT_FILE_PATH" value="$PROJECT_DIR$/SpendingApp.Migrations/SpendingApp.Migrations.csproj" />
       <option name="LAUNCH_PROFILE_TFM" value="net6.0" />
       <option name="LAUNCH_PROFILE_NAME" value="IIS Express" />
       <option name="USE_EXTERNAL_CONSOLE" value="0" />
@@ -95,6 +143,13 @@
       <workItem from="1667683645329" duration="1494000" />
       <workItem from="1667730880014" duration="665000" />
       <workItem from="1668106000082" duration="7678000" />
+      <workItem from="1668235943235" duration="2296000" />
+      <workItem from="1668243780029" duration="1355000" />
+      <workItem from="1668265631947" duration="2542000" />
+      <workItem from="1668284007708" duration="1802000" />
+      <workItem from="1668327950903" duration="8063000" />
+      <workItem from="1669478205587" duration="3040000" />
+      <workItem from="1669670407029" duration="550000" />
     </task>
     <servers />
   </component>
@@ -121,6 +176,19 @@
             </endOffsets>
           </properties>
           <option name="timeStamp" value="1" />
+        </line-breakpoint>
+        <line-breakpoint enabled="true" type="DotNet Breakpoints">
+          <url>file://$PROJECT_DIR$/SpendingApp/Program.cs</url>
+          <line>23</line>
+          <properties documentPath="D:\MY PROGS AMA GANGSTA NAH\microservices\laba1\Microservices3course\SpendingService\SpendingApp\SpendingApp\Program.cs" initialLine="23" containingFunctionPresentation="">
+            <startOffsets>
+              <option value="519" />
+            </startOffsets>
+            <endOffsets>
+              <option value="541" />
+            </endOffsets>
+          </properties>
+          <option name="timeStamp" value="2" />
         </line-breakpoint>
       </breakpoints>
     </breakpoint-manager>
Index: SpendingApp.Migrations/Properties/launchSettings.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp.Migrations/Properties/launchSettings.json b/SpendingApp.Migrations/Properties/launchSettings.json
new file mode 100644
--- /dev/null	(date 1670184089578)
+++ b/SpendingApp.Migrations/Properties/launchSettings.json	(date 1670184089578)
@@ -0,0 +1,28 @@
+{
+  "iisSettings": {
+    "windowsAuthentication": false,
+    "anonymousAuthentication": true,
+    "iisExpress": {
+      "applicationUrl": "http://localhost:53434",
+      "sslPort": 44380
+    }
+  },
+  "profiles": {
+    "SpendingApp.Migrations": {
+      "commandName": "Project",
+      "dotnetRunMessages": true,
+      "launchBrowser": true,
+      "applicationUrl": "https://localhost:7243;http://localhost:5243",
+      "environmentVariables": {
+        "ASPNETCORE_ENVIRONMENT": "Development"
+      }
+    },
+    "IIS Express": {
+      "commandName": "IISExpress",
+      "launchBrowser": true,
+      "environmentVariables": {
+        "ASPNETCORE_ENVIRONMENT": "Development"
+      }
+    }
+  }
+}
Index: SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.cs b/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.cs
new file mode 100644
--- /dev/null	(date 1670184089795)
+++ b/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.cs	(date 1670184089795)
@@ -0,0 +1,31 @@
+using Microsoft.EntityFrameworkCore.Migrations;
+
+#nullable disable
+
+namespace SpendingApp.Migrations
+{
+    public partial class InitialMigration : Migration
+    {
+        protected override void Up(MigrationBuilder migrationBuilder)
+        {
+            migrationBuilder.CreateTable(
+                name: "Pings",
+                columns: table => new
+                {
+                    Id = table.Column<int>(type: "int", nullable: false)
+                        .Annotation("SqlServer:Identity", "1, 1"),
+                    Counter = table.Column<int>(type: "int", nullable: false)
+                },
+                constraints: table =>
+                {
+                    table.PrimaryKey("PK_Pings", x => x.Id);
+                });
+        }
+
+        protected override void Down(MigrationBuilder migrationBuilder)
+        {
+            migrationBuilder.DropTable(
+                name: "Pings");
+        }
+    }
+}
\ No newline at end of file
Index: SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.cs b/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.cs
new file mode 100644
--- /dev/null	(date 1670184089704)
+++ b/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.cs	(date 1670184089704)
@@ -0,0 +1,50 @@
+using Microsoft.EntityFrameworkCore.Migrations;
+
+#nullable disable
+
+namespace SpendingApp.Migrations
+{
+    public partial class CreateSpendingTable : Migration
+    {
+        protected override void Up(MigrationBuilder migrationBuilder)
+        {
+            migrationBuilder.Sql(@"
+				IF OBJECT_ID('dbo.Pings', 'u' ) is not null
+				begin 
+					drop table dbo.Pings
+				end
+				
+				IF OBJECT_ID('dbo.Spendings', 'u' ) is null
+				begin 
+					create table dbo.Spendings
+					(
+						Id int identity(1,1),
+						Currency tinyint not null,
+						[Value] int not null,
+						[Item] nvarchar(max),
+
+						constraint PK_Spendings primary key clustered (Id asc)
+					)
+				end");
+        }
+
+        protected override void Down(MigrationBuilder migrationBuilder)
+        {
+	        migrationBuilder.Sql(@"
+				IF OBJECT_ID('dbo.Pings', 'u' ) is null
+				begin 
+					CREATE TABLE [dbo].[Pings]
+					(
+						[Id] [int] IDENTITY(1,1) NOT NULL,
+						[Counter] [int] NOT NULL,
+					 	CONSTRAINT [PK_Pings] PRIMARY KEY CLUSTERED ([Id] ASC)
+					)
+				end
+
+				IF OBJECT_ID('dbo.Spendings', 'u' ) is not null
+				begin 
+					drop table dbo.Spendings
+				end");
+        }
+    }
+}
Index: SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.Designer.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.Designer.cs b/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.Designer.cs
new file mode 100644
--- /dev/null	(date 1670184089806)
+++ b/SpendingApp/Persistence/Migrations/20221110195816_InitialMigration.Designer.cs	(date 1670184089806)
@@ -0,0 +1,44 @@
+// <auto-generated />
+using Microsoft.EntityFrameworkCore;
+using Microsoft.EntityFrameworkCore.Infrastructure;
+using Microsoft.EntityFrameworkCore.Metadata;
+using Microsoft.EntityFrameworkCore.Migrations;
+using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
+using SpendingApp.Persistence;
+
+#nullable disable
+
+namespace SpendingApp.Migrations
+{
+    [DbContext(typeof(SpendingContext))]
+    [Migration("20221110195816_InitialMigration")]
+    partial class InitialMigration
+    {
+        protected override void BuildTargetModel(ModelBuilder modelBuilder)
+        {
+#pragma warning disable 612, 618
+            modelBuilder
+                .HasAnnotation("ProductVersion", "6.0.0")
+                .HasAnnotation("Relational:MaxIdentifierLength", 128);
+
+            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
+
+            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
+                {
+                    b.Property<int>("Id")
+                        .ValueGeneratedOnAdd()
+                        .HasColumnType("int");
+
+                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
+
+                    b.Property<int>("Counter")
+                        .HasColumnType("int");
+
+                    b.HasKey("Id");
+
+                    b.ToTable("Pings");
+                });
+#pragma warning restore 612, 618
+        }
+    }
+}
Index: SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.Designer.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.Designer.cs b/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.Designer.cs
new file mode 100644
--- /dev/null	(date 1670184089756)
+++ b/SpendingApp/Persistence/Migrations/20221110213358_CreateSpendingTable.Designer.cs	(date 1670184089756)
@@ -0,0 +1,44 @@
+// <auto-generated />
+using Microsoft.EntityFrameworkCore;
+using Microsoft.EntityFrameworkCore.Infrastructure;
+using Microsoft.EntityFrameworkCore.Metadata;
+using Microsoft.EntityFrameworkCore.Migrations;
+using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
+using SpendingApp.Persistence;
+
+#nullable disable
+
+namespace SpendingApp.Migrations
+{
+    [DbContext(typeof(SpendingContext))]
+    [Migration("20221110213358_CreateSpendingTable")]
+    partial class CreateSpendingTable
+    {
+        protected override void BuildTargetModel(ModelBuilder modelBuilder)
+        {
+#pragma warning disable 612, 618
+            modelBuilder
+                .HasAnnotation("ProductVersion", "6.0.0")
+                .HasAnnotation("Relational:MaxIdentifierLength", 128);
+
+            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
+
+            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
+                {
+                    b.Property<int>("Id")
+                        .ValueGeneratedOnAdd()
+                        .HasColumnType("int");
+
+                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
+
+                    b.Property<int>("Counter")
+                        .HasColumnType("int");
+
+                    b.HasKey("Id");
+
+                    b.ToTable("Pings");
+                });
+#pragma warning restore 612, 618
+        }
+    }
+}
Index: SpendingApp/Persistence/Migrations/Helpers/MigrationsHelper.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/Helpers/MigrationsHelper.cs b/SpendingApp/Persistence/Migrations/Helpers/MigrationsHelper.cs
new file mode 100644
--- /dev/null	(date 1670184089582)
+++ b/SpendingApp/Persistence/Migrations/Helpers/MigrationsHelper.cs	(date 1670184089582)
@@ -0,0 +1,29 @@
+using Microsoft.EntityFrameworkCore;
+
+namespace SpendingApp.Persistence.Migrations.Helpers;
+
+public static class MigrationsHelper
+{
+    public static void ApplyMigrations(this WebApplication app)
+    {
+        using var scope = app.Services.CreateScope();
+        var dbContext = scope.ServiceProvider.GetRequiredService<SpendingContext>();
+
+        if (!app.Environment.IsProduction())
+        {
+            return;
+        }
+
+        try
+        {
+            app.Logger.LogError("Migrations applying started!");
+            dbContext.Database.Migrate();
+            app.Logger.LogError("Migrations applying ended!");
+        }
+        catch (Exception ex)
+        {
+            app.Logger.LogError($"Could not apply migrations. {ex.Message}");
+            throw;
+        }
+    }
+}
\ No newline at end of file
Index: SpendingApp/Persistence/Migrations/SpendingContextModelSnapshot.cs
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/SpendingApp/Persistence/Migrations/SpendingContextModelSnapshot.cs b/SpendingApp/Persistence/Migrations/SpendingContextModelSnapshot.cs
new file mode 100644
--- /dev/null	(date 1670184089672)
+++ b/SpendingApp/Persistence/Migrations/SpendingContextModelSnapshot.cs	(date 1670184089672)
@@ -0,0 +1,42 @@
+// <auto-generated />
+using Microsoft.EntityFrameworkCore;
+using Microsoft.EntityFrameworkCore.Infrastructure;
+using Microsoft.EntityFrameworkCore.Metadata;
+using Microsoft.EntityFrameworkCore.Storage.ValueConversion;
+using SpendingApp.Persistence;
+
+#nullable disable
+
+namespace SpendingApp.Migrations
+{
+    [DbContext(typeof(SpendingContext))]
+    partial class SpendingContextModelSnapshot : ModelSnapshot
+    {
+        protected override void BuildModel(ModelBuilder modelBuilder)
+        {
+#pragma warning disable 612, 618
+            modelBuilder
+                .HasAnnotation("ProductVersion", "6.0.0")
+                .HasAnnotation("Relational:MaxIdentifierLength", 128);
+
+            SqlServerModelBuilderExtensions.UseIdentityColumns(modelBuilder, 1L, 1);
+
+            modelBuilder.Entity("SpendingApp.Persistence.PingItem", b =>
+                {
+                    b.Property<int>("Id")
+                        .ValueGeneratedOnAdd()
+                        .HasColumnType("int");
+
+                    SqlServerPropertyBuilderExtensions.UseIdentityColumn(b.Property<int>("Id"), 1L, 1);
+
+                    b.Property<int>("Counter")
+                        .HasColumnType("int");
+
+                    b.HasKey("Id");
+
+                    b.ToTable("Pings");
+                });
+#pragma warning restore 612, 618
+        }
+    }
+}
Index: ../../k8s/spending/deployment.yaml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>apiVersion: apps/v1\r\nkind: Deployment\r\nmetadata:\r\n  name: spending-deployment\r\nspec:\r\n  replicas: 1                      # кількість екземплярів Pod, що буде створено цим Deployment\r\n  selector:\r\n    matchLabels:\r\n      app: spending              # селектор по якому Deployment зв'язаний з Pod\r\n  template:\r\n    metadata:\r\n     labels:\r\n       app: spending               # мітка Pod по якому вона буде зв'язана з Deployment та Service\r\n    spec:\r\n      containers:\r\n        - image: spending:latest       # образ Docker\r\n          imagePullPolicy: Never   # вказує k8s, що образ не потрібно завантажувати (варто використовувати лише для випадків, коли образи локальні)\r\n          name: spending           # ім'я контейнеру\r\n          ports:\r\n            - containerPort: 80  # порт по якому можна звертатись до поди
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/../../k8s/spending/deployment.yaml b/../../k8s/spending/deployment.yaml
--- a/../../k8s/spending/deployment.yaml	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/../../k8s/spending/deployment.yaml	(date 1670184089611)
@@ -12,9 +12,23 @@
      labels:
        app: spending               # мітка Pod по якому вона буде зв'язана з Deployment та Service
     spec:
+      initContainers:
+        - name: run-migrations
+          image: spending-migrations:latest
+          command: ["dotnet", "ef", "database", "update"]
+          env:
+            - name: POSTGRE_SQL
+              value: "postgres://demo:demo@postgres:5432/demo?sslmode=disable"
+            - name: VERSION
+              value: "20211128095755"
       containers:
         - image: spending:latest       # образ Docker
           imagePullPolicy: Never   # вказує k8s, що образ не потрібно завантажувати (варто використовувати лише для випадків, коли образи локальні)
           name: spending           # ім'я контейнеру
           ports:
-            - containerPort: 80  # порт по якому можна звертатись до поди
\ No newline at end of file
+            - containerPort: 80  # порт по якому можна звертатись до поди
+          envFrom:
+          - configMapRef:
+              name: spending-config
+          - secretRef:
+              name: spending-secret
\ No newline at end of file
Index: ../../k8s/postgres/secret.yaml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>apiVersion: v1\r\nkind: Secret\r\ntype: Opaque\r\nmetadata:\r\n  name: postgres-secret\r\ndata:\r\n  POSTGRES_USER: \"\"\r\n  POSTGRES_PASSWORD: \"\"
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/../../k8s/postgres/secret.yaml b/../../k8s/postgres/secret.yaml
--- a/../../k8s/postgres/secret.yaml	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/../../k8s/postgres/secret.yaml	(date 1670184089610)
@@ -4,5 +4,5 @@
 metadata:
   name: postgres-secret
 data:
-  POSTGRES_USER: ""
-  POSTGRES_PASSWORD: ""
\ No newline at end of file
+  POSTGRES_USER: "ZGVtbw=="
+  POSTGRES_PASSWORD: "ZGVtbw=="
\ No newline at end of file
Index: ../../k8s/postgres/storage.yaml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>apiVersion: v1\r\nkind: PersistentVolumeClaim\r\nmetadata:\r\n  name: postgres-volume-claim\r\nspec:\r\n  accessModes:\r\n    - ReadWriteOnce\r\n  resources:\r\n    requests:\r\n      storage: 1Gi
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/../../k8s/postgres/storage.yaml b/../../k8s/postgres/storage.yaml
--- a/../../k8s/postgres/storage.yaml	(revision be7f4e2b46454818cfe08fc53be8846fad6d7a65)
+++ b/../../k8s/postgres/storage.yaml	(date 1670184089611)
@@ -7,4 +7,4 @@
     - ReadWriteOnce
   resources:
     requests:
-      storage: 1Gi
\ No newline at end of file
+      storage: 5Gi
\ No newline at end of file
